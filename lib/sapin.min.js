!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("lodash"),require("date-fns")):"function"==typeof define&&define.amd?define("sapin",["lodash","date-fns"],r):"object"==typeof exports?exports.sapin=r(require("lodash"),require("date-fns")):e.sapin=r(e._,e.datefns)}("undefined"!=typeof self?self:this,function(e,r){return function(e){function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=7)}([function(r,t){r.exports=e},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isEmptyValue=r.isPureObject=void 0;var n=t(0);r.isPureObject=function(e){return(0,n.isObject)(e)&&!(0,n.isArray)(e)&&!(0,n.isFunction)(e)},r.isEmptyValue=function(e){return null===e||void 0===e||""===e}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Errors={required:"sapin.required",isInteger:"sapin.invalidInteger",isPositive:"sapin.valueShouldBePositive",isNegative:"sapin.valueShouldBeNegative",isGt:"sapin.valueShouldBeGt",isGte:"sapin.valueShouldBeGte",isLt:"sapin.valueShouldBeLt",isLte:"sapin.valueShouldBeLte",isGtField:"sapin.valueShouldBeGtField",isGteToField:"sapin.valueShouldBeGteField",isLtField:"sapin.valueShouldBeLtField",isLteToField:"sapin.valueShouldBeLteField",withinRange:"sapin.valueNotInRange",minLength:"sapin.valueNotLongEnough",maxLength:"sapin.valueTooLong",isEmail:"sapin.invalidEmail",isOfTypeArray:"sapin.notAnArray",isOfTypeObject:"sapin.notAnObject",isNumber:"sapin.invalidNumber",isOfTypeBool:"sapin.notBoolean",isOfTypeString:"sapin.notString",isOfTypeDate:"sapin.invalidDate"}},function(e,r,t){"use strict";function n(e,r){return(0,f.isArray)(e)?[r].concat(e):e?[r,e]:[r]}function i(e){if(!b[e])throw new TypeError("valueType must be one of the values defined in ValueTypes")}function u(e){if((0,f.isNil)(e)||!(0,f.isFunction)(e))throw new TypeError("getter must be a function")}function o(e){if(!(0,f.isNil)(e)&&!(0,f.isFunction)(e))throw new TypeError("transform must be a function")}function a(e){if(!(0,f.isNil)(e)&&!(0,f.isFunction)(e))throw new TypeError("typeValidator is optional but must be a Validation function if given")}function l(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;i(e),u(r),g(e,t),a(l),o(s),g(b.value,f,"collectionValidator"),this.valueType=e,this.getter=r,this.transform=s||r,this.validators=l?n(t,l):t,this.collectionValidator=f}function s(e,r,t){g(b.value,r,"collectionValidator"),(0,f.isFunction)(e)?e=e():e instanceof y.default&&(e=e.schema);var i=m(e);return r=n(r,t),new l(i,f.identity,e,null,null,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.dictionary=r.arrayOf=r.boolean=r.date=r.number=r.string=r.ValueTypes=void 0,r.PropertyDefinition=l;var f=t(0),c=t(5),d=t(6),p=t(1),v=t(4),y=function(e){return e&&e.__esModule?e:{default:e}}(v),b=r.ValueTypes={value:"value",collectionOfValues:"collectionOfValues",collectionOfObjects:"collectionOfObjects"},g=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validators";if(!(!!(0,f.isNil)(r)||(e===b.value?(0,f.isArray)(r)?(0,f.every)(r,f.isFunction):(0,f.isFunction)(r):(0,p.isPureObject)(r))))throw new TypeError(t+" must be a function or an array of functions")},m=(r.string=function(e,r){var t=r&&!1===r.useTrim,n=t?c.getString:c.getTrimmedString;return new l(b.value,n,e,d.isOfTypeString)},r.number=function(e,r){var t=r&&!1===r.replaceComa,n=t?c.getNumber:c.getFriendlyNumber;return new l(b.value,n,e,d.isNumber)},r.date=function(e){return new l(b.value,c.getDate,e,d.isOfTypeDate)},r.boolean=function(e){return new l(b.value,f.identity,e,d.isOfTypeBool)},function(e){if(e instanceof l)return b.collectionOfValues;if((0,p.isPureObject)(e))return b.collectionOfObjects;throw new TypeError("expect a type (ex.: string, number, etc.) or an object the expected properties")});r.arrayOf=function(e){return s(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d.isOfTypeArray)},r.dictionary=function(e){return s(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d.isOfTypeObject)}},function(e,r,t){"use strict";function n(e,r,t){for(var s in e){var f=e[s];t?((0,u.isFunction)(f)||(0,u.isArray)(f))&&(f=e[s]=new o.PropertyDefinition(o.ValueTypes.value,l.getString,f)):(0,u.isFunction)(f)&&(f=e[s]=f());var c=r.concat([s]);if(f instanceof i)e[s]=f.schema;else if(f instanceof o.PropertyDefinition)f.valueType===o.ValueTypes.collectionOfObjects&&n(f.validators,c,t);else{if(!(0,a.isPureObject)(f)){var d=c.join(".");if(t)throw new TypeError("Expect a collection or validator at property "+d);throw new TypeError("Expect an object or a type function (ex.: string, number) in schema at property "+d)}n(f,c,t)}}}function i(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,u.isNil)(e)||!(0,a.isPureObject)(e))throw new TypeError("schema must be a valid schema object");n(e,[],r),this.schema=e}Object.defineProperty(r,"__esModule",{value:!0});var u=t(0),o=t(3),a=t(1),l=t(5);r.default=i},function(e,r,t){"use strict";function n(e){return(0,u.isNil)(e)?null:(0,u.trim)(e.toString())}function i(e){return(0,u.isNil)(e)?e=null:((0,u.isString)(e)&&(e=e.replace(",",".")),e=Number(e)),e}Object.defineProperty(r,"__esModule",{value:!0}),r.getDate=r.getNumber=r.getString=void 0,r.getTrimmedString=n,r.getFriendlyNumber=i;var u=t(0);r.getString=function(e){return(0,u.isNil)(e)?null:e.toString()},r.getNumber=function(e){return(0,u.isNil)(e)?null:Number(e)},r.getDate=function(e){return e?new Date(e):null}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isOfTypeDate=r.isOfTypeString=r.isOfTypeBool=r.isNumber=r.isOfTypeObject=r.isOfTypeArray=void 0;var n=t(0),i=t(8),u=t(1),o=t(2);r.isOfTypeArray=function(e){var r=e.value;return r&&!(0,n.isArray)(r)?o.Errors.isOfTypeArray:null},r.isOfTypeObject=function(e){var r=e.value;return!r||!(0,n.isArray)(r)&&(0,n.isObject)(r)?null:o.Errors.isOfTypeObject},r.isNumber=function(e){var r=e.value,t=e.getter;return isNaN(t(r))?o.Errors.isNumber:null},r.isOfTypeBool=function(e){var r=e.value;return!0===r||!1===r?null:o.Errors.isOfTypeBool},r.isOfTypeString=function(e){var r=e.value;return(0,u.isEmptyValue)(r)||(0,n.isString)(r)?null:o.Errors.isOfTypeString},r.isOfTypeDate=function(e){var r=e.value,t=e.getter;return(0,u.isEmptyValue)(r)||(0,i.isValid)(t(r))?null:o.Errors.isOfTypeDate}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=t(4);Object.defineProperty(r,"Schema",{enumerable:!0,get:function(){return n(i).default}});var u=t(2);Object.defineProperty(r,"Errors",{enumerable:!0,get:function(){return u.Errors}});var o=t(5);Object.defineProperty(r,"getString",{enumerable:!0,get:function(){return o.getString}}),Object.defineProperty(r,"getFriendlyNumber",{enumerable:!0,get:function(){return o.getFriendlyNumber}}),Object.defineProperty(r,"getTrimmedString",{enumerable:!0,get:function(){return o.getTrimmedString}}),Object.defineProperty(r,"getDate",{enumerable:!0,get:function(){return o.getDate}}),Object.defineProperty(r,"getNumber",{enumerable:!0,get:function(){return o.getNumber}});var a=t(9);Object.defineProperty(r,"isNegative",{enumerable:!0,get:function(){return a.isNegative}}),Object.defineProperty(r,"isPositive",{enumerable:!0,get:function(){return a.isPositive}}),Object.defineProperty(r,"isGt",{enumerable:!0,get:function(){return a.isGt}}),Object.defineProperty(r,"isGte",{enumerable:!0,get:function(){return a.isGte}}),Object.defineProperty(r,"isGteToField",{enumerable:!0,get:function(){return a.isGteToField}}),Object.defineProperty(r,"isGtField",{enumerable:!0,get:function(){return a.isGtField}}),Object.defineProperty(r,"isInteger",{enumerable:!0,get:function(){return a.isInteger}}),Object.defineProperty(r,"isLt",{enumerable:!0,get:function(){return a.isLt}}),Object.defineProperty(r,"isLte",{enumerable:!0,get:function(){return a.isLte}}),Object.defineProperty(r,"isLteToField",{enumerable:!0,get:function(){return a.isLteToField}}),Object.defineProperty(r,"isLtField",{enumerable:!0,get:function(){return a.isLtField}}),Object.defineProperty(r,"withinRange",{enumerable:!0,get:function(){return a.withinRange}});var l=t(10);Object.defineProperty(r,"required",{enumerable:!0,get:function(){return l.required}}),Object.defineProperty(r,"requiredIfOtherFieldEquals",{enumerable:!0,get:function(){return l.requiredIfOtherFieldEquals}}),Object.defineProperty(r,"requiredIfOtherFieldIsFalse",{enumerable:!0,get:function(){return l.requiredIfOtherFieldIsFalse}}),Object.defineProperty(r,"requiredIfOtherFieldIsTrue",{enumerable:!0,get:function(){return l.requiredIfOtherFieldIsTrue}});var s=t(11);Object.defineProperty(r,"minLength",{enumerable:!0,get:function(){return s.minLength}}),Object.defineProperty(r,"maxLength",{enumerable:!0,get:function(){return s.maxLength}}),Object.defineProperty(r,"isEmail",{enumerable:!0,get:function(){return s.isEmail}});var f=t(12);Object.defineProperty(r,"transform",{enumerable:!0,get:function(){return f.transform}});var c=t(6);Object.defineProperty(r,"isNumber",{enumerable:!0,get:function(){return c.isNumber}}),Object.defineProperty(r,"isOfTypeString",{enumerable:!0,get:function(){return c.isOfTypeString}}),Object.defineProperty(r,"isOfTypeObject",{enumerable:!0,get:function(){return c.isOfTypeObject}}),Object.defineProperty(r,"isOfTypeDate",{enumerable:!0,get:function(){return c.isOfTypeDate}}),Object.defineProperty(r,"isOfTypeArray",{enumerable:!0,get:function(){return c.isOfTypeArray}}),Object.defineProperty(r,"isOfTypeBool",{enumerable:!0,get:function(){return c.isOfTypeBool}});var d=t(1);Object.defineProperty(r,"isPureObject",{enumerable:!0,get:function(){return d.isPureObject}}),Object.defineProperty(r,"isEmptyValue",{enumerable:!0,get:function(){return d.isEmptyValue}});var p=t(3);Object.defineProperty(r,"string",{enumerable:!0,get:function(){return p.string}}),Object.defineProperty(r,"dictionary",{enumerable:!0,get:function(){return p.dictionary}}),Object.defineProperty(r,"boolean",{enumerable:!0,get:function(){return p.boolean}}),Object.defineProperty(r,"arrayOf",{enumerable:!0,get:function(){return p.arrayOf}}),Object.defineProperty(r,"date",{enumerable:!0,get:function(){return p.date}}),Object.defineProperty(r,"number",{enumerable:!0,get:function(){return p.number}}),Object.defineProperty(r,"PropertyDefinition",{enumerable:!0,get:function(){return p.PropertyDefinition}}),Object.defineProperty(r,"ValueTypes",{enumerable:!0,get:function(){return p.ValueTypes}});var v=t(13);Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return v.validate}})},function(e,t){e.exports=r},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.withinRange=r.isLtField=r.isLteToField=r.isGtField=r.isGteToField=r.isLt=r.isLte=r.isGt=r.isGte=r.isNegative=r.isPositive=r.isInteger=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=t(0),u=t(2),o=t(1),a=(r.isInteger=function(e){var r=e.value,t=e.getter;if((0,o.isEmptyValue)(r))return null;var n=t(r);return Number.isInteger(n)?null:u.Errors.isInteger},r.isPositive=function(e){var r=e.value,t=e.getter;return(0,o.isEmptyValue)(r)?null:t(r)<0?u.Errors.isPositive:null},r.isNegative=function(e){var r=e.value,t=e.getter;return(0,o.isEmptyValue)(r)?null:t(r)>=0?u.Errors.isNegative:null},function(e,r,t,i,u,a,l){if((0,o.isEmptyValue)(e))return null;var s=null,f=u(e),c=u(i[r]);return isNaN(f)||isNaN(c)||(void 0===f?"undefined":n(f))!==(void 0===c?"undefined":n(c))||(s=a(f,c)?null:{error:l,params:{value:e,otherFieldValue:c,otherFieldLabel:t}}),s}),l=function(e,r,t,n,i){if((0,o.isEmptyValue)(e))return null;var u=null;return t=n(t),e=n(e),isNaN(e)||r(e,t)||(u={error:i,params:{value:e,threshold:t}}),u},s=(r.isGte=function(e){return function(r){var t=r.value,n=r.getter;return l(t,i.gte,e,n,u.Errors.isGte)}},r.isGt=function(e){return function(r){var t=r.value,n=r.getter;return l(t,i.gt,e,n,u.Errors.isGt)}},r.isLte=function(e){return function(r){var t=r.value,n=r.getter;return l(t,i.lte,e,n,u.Errors.isLte)}},r.isLt=function(e){return function(r){var t=r.value,n=r.getter;return l(t,i.lt,e,n,u.Errors.isLt)}},r.isGteToField=function(e,r){return function(t){var n=t.value,o=t.siblings,l=t.getter;return a(n,e,r,o,l,i.gte,u.Errors.isGteToField)}},r.isGtField=function(e,r){return function(t){var n=t.value,o=t.siblings,l=t.getter;return a(n,e,r,o,l,i.gt,u.Errors.isGtField)}},r.isLteToField=function(e,r){return function(t){var n=t.value,o=t.siblings,l=t.getter;return a(n,e,r,o,l,i.lte,u.Errors.isLteToField)}},r.isLtField=function(e,r){return function(t){var n=t.value,o=t.siblings,l=t.getter;return a(n,e,r,o,l,i.lt,u.Errors.isLtField)}},function(e,r){if((0,i.isNil)(e)||(0,i.isNil)(r))throw new Error("minValue and maxValue cannot be null");if(e>r)throw new Error("minValue > maxValue");if((void 0===e?"undefined":n(e))!==(void 0===r?"undefined":n(r)))throw new Error("range value must be of the same type")});r.withinRange=function(e,r){return s(e,r),function(t){var n=t.value,i=t.getter;if((0,o.isEmptyValue)(n))return null;var a=i(n);return a<e||a>r?{error:u.Errors.withinRange,params:{value:n,minValue:e,maxValue:r}}:null}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.requiredIfOtherFieldEquals=r.requiredIfOtherFieldIsFalse=r.requiredIfOtherFieldIsTrue=r.required=void 0;var n=t(0),i=t(2),u=t(1),o=r.required=function(e){var r=e.value;return(0,u.isEmptyValue)(r)?i.Errors.required:null};r.requiredIfOtherFieldIsTrue=function(e){return function(r){return(0,n.get)(r.siblings,e,!1)?o(r):null}},r.requiredIfOtherFieldIsFalse=function(e){return function(r){return(0,n.get)(r.siblings,e,!0)?null:o(r)}},r.requiredIfOtherFieldEquals=function(e,r){r=(0,n.isArray)(r)?r:[r];var t=new Set(r);return function(r){var i=(0,n.get)(r.siblings,e,!1);return t.has(i)?o(r):null}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.maxLength=r.minLength=r.isEmail=void 0;var n=t(2),i=t(1),u=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;r.isEmail=function(e){var r=e.value;e.config;return(0,i.isEmptyValue)(r)?null:u.test(r)?null:n.Errors.isEmail},r.minLength=function(e){return function(r){var t=r.value,u=null;return!(0,i.isEmptyValue)(t)&&t.length<e&&(u={error:n.Errors.minLength,params:{value:t,minLength:e}}),u}},r.maxLength=function(e){return function(r){var t=r.value,u=null;return!(0,i.isEmptyValue)(t)&&t.length>e&&(u={error:n.Errors.maxLength,params:{value:t,maxLength:e}}),u}}},function(e,r,t){"use strict";function n(e,r){var t={};for(var i in e){var u=e[i],a=r[i];a instanceof o.PropertyDefinition?t[i]=l(u,a):t[i]=u&&a?n(u,a):u}return t}Object.defineProperty(r,"__esModule",{value:!0});var i=t(0),u=t(1),o=t(3),a=t(6),l=function(e,r){if(r.valueType===o.ValueTypes.value)return r.transform(e);if((0,i.isArray)(e)&&r.collectionValidator.indexOf(a.isOfTypeArray)>-1){var t=r.validators;return e.map(function(e){return t.transform(e)})}if((0,u.isPureObject)(e)&&r.collectionValidator.indexOf(a.isOfTypeObject)>-1){var l={};for(var s in e)l[s]=n(e[s],r.validators);return l}return e},s=function(e,r){return n(e,r.schema)};r.default=s},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validate=void 0;var n=t(0),i=t(3),u=t(4),o=(function(e){e&&e.__esModule}(u),function(e,r,t,i,u,o){var a=null;(0,n.isArray)(r)||(r=[r]);for(var l=0;!a&&l<r.length;l++){a=(0,r[l])({value:e,getter:t,siblings:i,entity:u,params:o})}return a}),a=function(e,r,t,i,u){var o={};return(0,n.forEach)(e,function(n,a){var l=f(e[a],r.validators,e[a],t,i,u);l&&(o[a.toString()]=l)}),(0,n.isEmpty)(o)?null:o},l=function(e,r,t,i,u){var a={};return(0,n.forEach)(e,function(t,n){var l=e[n],s=o(l,r.validators.validators,r.validators.getter,e,i,u);s&&(a[n.toString()]=s)}),(0,n.isEmpty)(a)?null:a},s=function(e,r,t,n,u,s){if(r.valueType===i.ValueTypes.value)return o(e,r.validators,r.getter,t,n,u);if(r.collectionValidator){var f=o(e,r.collectionValidator,r.getter,t,n,u);if(f)return{_error:f}}return r.valueType===i.ValueTypes.collectionOfObjects?a(e,r,n,u,s):l(e,r,0,n,u)},f=function e(r,t,u,o,a,l){var f={};for(var c in t){var d=r?r[c]:null,p=t[c],v=void 0;v=p instanceof i.PropertyDefinition?s(d,p,u,o,a,l):e(d,p,d,o,a,l),v&&(f[c]=v)}if(l)for(var y in r)t[y]||(f[y]="sapin.unknownProperty");return(0,n.isEmpty)(f)?null:f};r.validate=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return f(e,r.schema,e,e,t,n)}}])});